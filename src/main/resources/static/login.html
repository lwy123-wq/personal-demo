<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <script type="text/javascript">
        var ws;
        var url = "ws://localhost:8848/ws";
        window.onload = connect;
        var currentUsers = [];

        function connect() {
            if ('WebSocket' in window) {
                ws = new WebSocket(url);
            } else if ('MozWebSocket' in window) {
                ws = new MozWebSocket(url);
            } else {
                alert('该浏览器不支持websocket');
                return;
            }

            ws.open = function () {

            };
        }
        function wsSend() {
            var username = document.getElementById("username");
            var password= document.getElementById("password");
            ws.send(JSON.stringify({"username": username.value, "password": password.value}));
            // msg.value = "";
        }
    </script>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script>
        $(function () {
            $("#submit").on('click', function () {
                $.ajax({
                    url: "/loginn",
                    type: 'POST',
                    data: {'username': $("#username").val(), 'password': $("#password").val()},
                    success: function (res) {
                        if(res=="success"){
                            wsSend()
                            alert("success")
                            function login(){
                                window.location.href='chat_client.html'
                            }
                            login()
                        }else{
                            alert("error");
                        }
                    },
                    error: function (res) {
                        alert("error!!!!!")
                    }
                    });
            })
        });

    </script>
</head>
<body>
<h2>登录</h2>
用户名<input id="username" type="text"/>
密码<input id="password" type="password"/>
<input id="submit" type="submit" value="提交"/>
</body>
</html>